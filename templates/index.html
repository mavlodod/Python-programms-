<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–£—á–µ—Ç —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            padding: 30px;
            background-color: #f8f9fa;
        }
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
        }
        .birthday-tomorrow {
            background-color: #fff3cd !important;
        }
        .hidden {
            display: none;
        }
    </style>
</head>
<body>
<div class="container">
    <!-- –®–∞–ø–∫–∞ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ -->
    <div class="header">
        <div class="d-flex justify-content-between align-items-center">
            <div>
                <h1>üéÇ –£—á–µ—Ç –¥–Ω–µ–π —Ä–æ–∂–¥–µ–Ω–∏—è</h1>
                <p class="mb-0">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, <strong>{{ username }}</strong>!</p>
            </div>
            <div>
                <a href="{{ url_for('logout') }}" class="btn btn-light">–í—ã–π—Ç–∏</a>
                {% if username == 'admin' %}
                <a href="{{ url_for('manage_users') }}" class="btn btn-outline-light ms-2">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏</a>
                {% endif %}
            </div>
        </div>
    </div>

    <!-- –°–æ–æ–±—â–µ–Ω–∏—è flash -->
    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            {% for category, message in messages %}
                <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
                    {{ message }}
                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                </div>
            {% endfor %}
        {% endif %}
    {% endwith %}

    <!-- –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ -->
    <div class="card mb-4 shadow-sm">
        <div class="card-header bg-primary text-white">
            <h5 class="mb-0">–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–≥–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞</h5>
        </div>
        <div class="card-body">
            <form method="POST">
                <input type="hidden" name="action" value="add_employee">
                <div class="row mb-3">
                    <div class="col-md-6">
                        <input type="text" class="form-control" name="name" placeholder="–ò–º—è –∏ –§–∞–º–∏–ª–∏—è" required>
                    </div>
                    <div class="col-md-3">
                        <input type="date" class="form-control" name="dob" required>
                    </div>
                    <div class="col-md-3">
                        <button type="submit" class="btn btn-success w-100">
                            <i class="bi bi-person-plus"></i> –î–æ–±–∞–≤–∏—Ç—å
                        </button>
                    </div>
                </div>
            </form>
        </div>
    </div>

    <!-- –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π -->
    <div class="mb-3">
        <button id="toggleListBtn" class="btn btn-primary me-2">
            <i class="bi bi-list"></i> –ü–æ–∫–∞–∑–∞—Ç—å/—Å–∫—Ä—ã—Ç—å —Å–ø–∏—Å–æ–∫ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤
        </button>
        <button id="toggleBirthdayBtn" class="btn btn-warning">
            <i class="bi bi-gift"></i> –ü–æ–∫–∞–∑–∞—Ç—å/—Å–∫—Ä—ã—Ç—å –¥–Ω–∏ —Ä–æ–∂–¥–µ–Ω–∏—è –∑–∞–≤—Ç—Ä–∞
        </button>
    </div>

    <!-- –°–ø–∏—Å–æ–∫ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ —Å –≤—ã–±–æ—Ä–æ–º –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è -->
    <div id="employeeList" class="card mb-4 shadow-sm hidden">
        <div class="card-header bg-secondary text-white">
            <h5 class="mb-0">–°–ø–∏—Å–æ–∫ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ ({{ employees|length }})</h5>
        </div>
        <div class="card-body">
            <form id="deleteForm" action="{{ url_for('delete_employees') }}" method="POST">
                <table class="table table-striped table-hover">
                    <thead>
                        <tr>
                            <th width="50px"><input type="checkbox" id="selectAll"></th>
                            <th>–ò–º—è</th>
                            <th>–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for emp in employees %}
                        <tr {% if emp.name in birthdays_tomorrow %}class="birthday-tomorrow"{% endif %}>
                            <td><input type="checkbox" name="delete_ids" value="{{ emp.id }}" class="delete-checkbox"></td>
                            <td>{{ emp.name }}</td>
                            <td>{{ emp.dob }}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
                <button type="submit" class="btn btn-danger" onclick="return confirm('–£–¥–∞–ª–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤?')">
                    <i class="bi bi-trash"></i> –£–¥–∞–ª–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω–æ–µ
                </button>
            </form>
        </div>
    </div>

    <!-- –î–Ω–∏ —Ä–æ–∂–¥–µ–Ω–∏—è –∑–∞–≤—Ç—Ä–∞ -->
    <div id="birthdayList" class="card mb-4 shadow-sm hidden">
        <div class="card-header bg-warning">
            <h5 class="mb-0">üéâ –î–Ω–∏ —Ä–æ–∂–¥–µ–Ω–∏—è –∑–∞–≤—Ç—Ä–∞</h5>
        </div>
        <div class="card-body">
            <div class="row">
                {% for name in birthdays_tomorrow %}
                <div class="col-md-4 mb-2">
                    <div class="alert alert-success">
                        <i class="bi bi-balloon"></i> {{ name }}
                    </div>
                </div>
                {% else %}
                <div class="col-12">
                    <div class="alert alert-info">
                        <i class="bi bi-info-circle"></i> –ó–∞–≤—Ç—Ä–∞ –Ω–∏–∫—Ç–æ –Ω–µ –ø—Ä–∞–∑–¥–Ω—É–µ—Ç –¥–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
    </div>
</div>

<!-- Bootstrap Icons -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<script>
    // –≠–ª–µ–º–µ–Ω—Ç—ã DOM
    const employeeList = document.getElementById('employeeList');
    const birthdayList = document.getElementById('birthdayList');
    const toggleListBtn = document.getElementById('toggleListBtn');
    const toggleBirthdayBtn = document.getElementById('toggleBirthdayBtn');
    const selectAllCheckbox = document.getElementById('selectAll');
    const deleteCheckboxes = document.querySelectorAll('.delete-checkbox');

    // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∏–¥–∏–º–æ—Å—Ç–∏ —Å–ø–∏—Å–∫–∞ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤
    toggleListBtn.addEventListener('click', () => {
        employeeList.classList.toggle('hidden');
    });

    // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∏–¥–∏–º–æ—Å—Ç–∏ –¥–Ω–µ–π —Ä–æ–∂–¥–µ–Ω–∏–π
    toggleBirthdayBtn.addEventListener('click', () => {
        birthdayList.classList.toggle('hidden');
    });

    // –í—ã–¥–µ–ª–∏—Ç—å –≤—Å–µ —á–µ–∫–±–æ–∫—Å—ã
    selectAllCheckbox.addEventListener('change', function() {
        deleteCheckboxes.forEach(checkbox => {
            checkbox.checked = this.checked;
        });
    });

    // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–ø–∏—Å–æ–∫, –µ—Å–ª–∏ –µ—Å—Ç—å –¥–Ω–∏ —Ä–æ–∂–¥–µ–Ω–∏—è –∑–∞–≤—Ç—Ä–∞
    {% if birthdays_tomorrow %}
    window.addEventListener('load', function() {
        birthdayList.classList.remove('hidden');
    });
    {% endif %}
</script>
</body>
</html>